<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Счетчик настольного тенниса</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1><i class="fas fa-table-tennis-paddle-ball"></i> Счетчик тенниса</h1>
                <div class="bot-status" id="botStatusIndicator">
                    <i class="fas fa-robot"></i>
                    <span>Бот: ВКЛ</span>
                </div>
            </div>
            <div class="match-info">
                <div class="sets-info">
                    <div class="info-item">
                        <span class="info-label">Сет:</span>
                        <span class="info-value"><span id="currentSet">1</span>/<span id="totalSets">5</span></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Игра до:</span>
                        <span class="info-value" id="pointsToWin">11</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Разница:</span>
                        <span class="info-value">2</span>
                    </div>
                </div>
                <div class="settings-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                </div>
            </div>
        </header>

        <main>
            <div class="scoreboard">
                <!-- Игрок 1 -->
                <div class="player" id="player1">
                    <div class="player-header">
                        <div class="player-name-container">
                            <input type="text" class="player-name" value="Игрок 1" maxlength="15">
                            <div class="player-color-indicator" style="background-color: #3498db;"></div>
                        </div>
                        <div class="player-sets">
                            <span class="sets-count" id="setsCount1">0</span>
                            <span class="sets-label">сетов</span>
                        </div>
                    </div>
                    <div class="score-display">
                        <div class="current-score" id="score1">0</div>
                        <div class="score-label">Текущий счет</div>
                    </div>
                    <div class="sets-display">
                        <div class="sets-container" id="sets1"></div>
                    </div>
                    <div class="score-controls">
                        <button class="btn-minus" data-player="1">
                            <i class="fas fa-minus"></i>
                        </button>
                        <div class="quick-add">
                            <button class="quick-btn" data-player="1" data-points="1">+1</button>
                            <button class="quick-btn" data-player="1" data-points="2">+2</button>
                            <button class="quick-btn" data-player="1" data-points="3">+3</button>
                        </div>
                        <button class="btn-plus" data-player="1">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="bot-command">
                        <button class="bot-command-btn" data-command="один">
                            <i class="fas fa-robot"></i> Бот: +1
                        </button>
                    </div>
                </div>

                <div class="vs-container">
                    <div class="vs">VS</div>
                    <div class="center-controls">
                        <button class="center-btn" id="swapPlayersBtn" title="Поменять игроков">
                            <i class="fas fa-exchange-alt"></i>
                        </button>
                        <button class="center-btn" id="resetPointsBtn" title="Сбросить очки">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                </div>

                <!-- Игрок 2 -->
                <div class="player" id="player2">
                    <div class="player-header">
                        <div class="player-name-container">
                            <div class="player-color-indicator" style="background-color: #e74c3c;"></div>
                            <input type="text" class="player-name" value="Игрок 2" maxlength="15">
                        </div>
                        <div class="player-sets">
                            <span class="sets-count" id="setsCount2">0</span>
                            <span class="sets-label">сетов</span>
                        </div>
                    </div>
                    <div class="score-display">
                        <div class="current-score" id="score2">0</div>
                        <div class="score-label">Текущий счет</div>
                    </div>
                    <div class="sets-display">
                        <div class="sets-container" id="sets2"></div>
                    </div>
                    <div class="score-controls">
                        <button class="btn-minus" data-player="2">
                            <i class="fas fa-minus"></i>
                        </button>
                        <div class="quick-add">
                            <button class="quick-btn" data-player="2" data-points="1">+1</button>
                            <button class="quick-btn" data-player="2" data-points="2">+2</button>
                            <button class="quick-btn" data-player="2" data-points="3">+3</button>
                        </div>
                        <button class="btn-plus" data-player="2">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="bot-command">
                        <button class="bot-command-btn" data-command="два">
                            <i class="fas fa-robot"></i> Бот: +1
                        </button>
                    </div>
                </div>
            </div>

            <div class="match-controls">
                <button id="undoBtn" class="btn-secondary">
                    <i class="fas fa-undo"></i> Отменить
                </button>
                <button id="newSetBtn" class="btn-primary">
                    <i class="fas fa-plus-circle"></i> Новый сет
                </button>
                <button id="newMatchBtn" class="btn-danger">
                    <i class="fas fa-play-circle"></i> Новая игра
                </button>
            </div>

            <div class="bot-controls">
                <h3><i class="fas fa-robot"></i> Управление через бота</h3>
                <div class="bot-buttons">
                    <button class="bot-action-btn" data-command="статус">
                        <i class="fas fa-info-circle"></i> Статус
                    </button>
                    <button class="bot-action-btn" data-command="один">
                        <i class="fas fa-user"></i> +1 Игрок 1
                    </button>
                    <button class="bot-action-btn" data-command="два">
                        <i class="fas fa-user"></i> +1 Игрок 2
                    </button>
                    <button class="bot-action-btn" data-command="сброс">
                        <i class="fas fa-redo"></i> Сброс
                    </button>
                </div>
                <div class="bot-toggle">
                    <label class="toggle-label">
                        <span>Обработка команд бота:</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="botToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </label>
                </div>
            </div>

            <div class="history">
                <div class="history-header">
                    <h3><i class="fas fa-history"></i> История игры</h3>
                    <button class="clear-history-btn" id="clearHistoryBtn">
                        <i class="fas fa-trash"></i> Очистить
                    </button>
                </div>
                <div id="historyLog"></div>
            </div>
        </main>
    </div>

    <!-- Модальное окно настроек -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Настройки игры</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3><i class="fas fa-gamepad"></i> Правила игры</h3>
                    <div class="form-group">
                        <label for="totalSetsSelect">Количество сетов:</label>
                        <select id="totalSetsSelect">
                            <option value="3">3 (победит 2)</option>
                            <option value="5" selected>5 (победит 3)</option>
                            <option value="7">7 (победит 4)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pointsToWinSelect">Очков для победы в сете:</label>
                        <select id="pointsToWinSelect">
                            <option value="11" selected>11 очков</option>
                            <option value="21">21 очко</option>
                            <option value="31">31 очко</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="minLeadSelect">Минимальная разница:</label>
                        <select id="minLeadSelect">
                            <option value="2" selected>2 очка</option>
                            <option value="1">1 очко</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3><i class="fas fa-user"></i> Игроки</h3>
                    <div class="player-settings">
                        <div class="player-setting">
                            <div class="player-color-preview" style="background-color: #3498db;"></div>
                            <input type="text" class="player-name-setting" id="player1Setting" value="Игрок 1" maxlength="15">
                            <button class="color-picker-btn" data-player="1">
                                <i class="fas fa-palette"></i>
                            </button>
                        </div>
                        <div class="player-setting">
                            <div class="player-color-preview" style="background-color: #e74c3c;"></div>
                            <input type="text" class="player-name-setting" id="player2Setting" value="Игрок 2" maxlength="15">
                            <button class="color-picker-btn" data-player="2">
                                <i class="fas fa-palette"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3><i class="fas fa-robot"></i> Настройки бота</h3>
                    <div class="form-group">
                        <label for="botEnabledToggle">Включить обработку команд:</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="botEnabledToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="soundToggle">Звуковые уведомления:</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="soundToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Доступные команды:</label>
                        <div class="commands-list">
                            <div class="command-item">
                                <code>один</code> или <code>1</code> - +1 очко Игроку 1
                            </div>
                            <div class="command-item">
                                <code>два</code> или <code>2</code> - +1 очко Игроку 2
                            </div>
                            <div class="command-item">
                                <code>сброс</code> - сбросить очки
                            </div>
                            <div class="command-item">
                                <code>статус</code> - текущий счет
                            </div>
                            <div class="command-item">
                                <code>новая игра</code> - начать заново
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveSettings" class="btn-primary">
                    <i class="fas fa-save"></i> Сохранить настройки
                </button>
            </div>
        </div>
    </div>

    <!-- Модальное окно выбора цвета -->
    <div id="colorModal" class="modal">
        <div class="modal-content small">
            <div class="modal-header">
                <h3><i class="fas fa-palette"></i> Выберите цвет</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="color-options-grid">
                    <div class="color-option" style="background-color: #3498db;" data-color="#3498db"></div>
                    <div class="color-option" style="background-color: #e74c3c;" data-color="#e74c3c"></div>
                    <div class="color-option" style="background-color: #2ecc71;" data-color="#2ecc71"></div>
                    <div class="color-option" style="background-color: #f39c12;" data-color="#f39c12"></div>
                    <div class="color-option" style="background-color: #9b59b6;" data-color="#9b59b6"></div>
                    <div class="color-option" style="background-color: #1abc9c;" data-color="#1abc9c"></div>
                    <div class="color-option" style="background-color: #34495e;" data-color="#34495e"></div>
                    <div class="color-option" style="background-color: #e67e22;" data-color="#e67e22"></div>
                    <div class="color-option" style="background-color: #16a085;" data-color="#16a085"></div>
                    <div class="color-option" style="background-color: #8e44ad;" data-color="#8e44ad"></div>
                    <div class="color-option" style="background-color: #27ae60;" data-color="#27ae60"></div>
                    <div class="color-option" style="background-color: #d35400;" data-color="#d35400"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Тестовые кнопки (только для разработки) -->
    <div id="testPanel" class="test-panel">
        <div class="test-panel-header">
            <h4><i class="fas fa-vial"></i> Тест команд бота</h4>
            <button class="test-panel-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="test-panel-content">
            <div class="test-buttons">
                <button class="test-btn" data-command="один">
                    <i class="fas fa-user"></i> +1 Игрок 1
                </button>
                <button class="test-btn" data-command="два">
                    <i class="fas fa-user"></i> +1 Игрок 2
                </button>
                <button class="test-btn" data-command="сброс">
                    <i class="fas fa-redo"></i> Сброс очков
                </button>
                <button class="test-btn" data-command="статус">
                    <i class="fas fa-info-circle"></i> Статус
                </button>
                <button class="test-btn" data-command="новая игра">
                    <i class="fas fa-play-circle"></i> Новая игра
                </button>
                <button class="test-btn" data-command="отмена">
                    <i class="fas fa-undo"></i> Отмена
                </button>
            </div>
            <div class="test-input">
                <input type="text" id="testCommandInput" placeholder="Введите команду...">
                <button id="sendTestCommand">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
